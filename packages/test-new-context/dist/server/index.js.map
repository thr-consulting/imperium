{"version":3,"sources":["../../src/server/index.ts"],"names":["serverModules","graphqlServerModule","todoSeverModule","d","testServerConnectors","Connector","mongo","connect","close","contextCreator","conn","todoDomain","someOtherDomain","server","ImperiumServer","connectors"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEO,MAAMA,aAA6B,GAAG,CAACC,kCAAD,EAAsBC,qBAAtB,CAAtC;;AAEP,MAAMC,CAAC,GAAG,oBAAM,kCAAN,CAAV,C,CAEA;;AACA,MAAMC,oBAAoB,GAAG,IAAIC,yBAAJ,CAAc;AAC1CC,EAAAA,KAAK,EAAE;AACN,UAAMC,OAAN,GAAgB;AACf,aAAO,CAAP;AACA,KAHK;;AAIN,UAAMC,KAAN,GAAc;AACbL,MAAAA,CAAC,CAAC,gCAAD,CAAD;AACA;;AANK;AADmC,CAAd,CAA7B;;AAWA,SAASM,cAAT,CAAwBC,IAAxB,EAA2D;AAC1D,SAAO;AACNC,IAAAA,UAAU,EAAE,2BAAcD,IAAd,CADN;AAENE,IAAAA,eAAe,EAAE;AAFX,GAAP;AAIA;;AAIM,MAAMC,MAAM,GAAG,IAAIC,eAAJ,CAAmB;AACxCL,EAAAA,cADwC;AAExCM,EAAAA,UAAU,EAAEX,oBAF4B;AAGxCJ,EAAAA;AAHwC,CAAnB,CAAf","sourcesContent":["import {Connector} from '@imperium/context-manager';\nimport {graphqlServerModule, ImperiumGraphqlServerModule} from '@imperium/graphql-server';\nimport ImperiumServer from '@imperium/server';\nimport debug from 'debug';\nimport {createContext} from '../domain';\nimport {todoSeverModule} from './todo';\n\nexport const serverModules: ServerModule[] = [graphqlServerModule, todoSeverModule];\n\nconst d = debug('imperium.test-new-context.server');\n\n// todo connectors should be the responsibility of the instantiating server. (in this case, the test server)\nconst testServerConnectors = new Connector({\n\tmongo: {\n\t\tasync connect() {\n\t\t\treturn 5;\n\t\t},\n\t\tasync close() {\n\t\t\td('closing test server connectors');\n\t\t},\n\t},\n});\n\nfunction contextCreator(conn: typeof testServerConnectors) {\n\treturn {\n\t\ttodoDomain: createContext(conn),\n\t\tsomeOtherDomain: {},\n\t};\n}\n\nexport type ServerModule = ImperiumGraphqlServerModule<ReturnType<typeof contextCreator>, typeof testServerConnectors>;\n\nexport const server = new ImperiumServer({\n\tcontextCreator,\n\tconnectors: testServerConnectors,\n\tserverModules,\n});\n"],"file":"index.js"}